# -*- coding: utf-8 -*-
from datetime import datetime

"""
Все тексты сообщений бота «Гвозди Просто»
Версия 2.0

Редактируйте тексты здесь — бот подхватит изменения.
Где [🎥 КРУЖОК: ...] — заменить на реальный video_note после записи.
"""

# ═══════════════════════════════════════════════════════════════
# ПРИВЕТСТВИЕ (сразу после /start)
# ═══════════════════════════════════════════════════════════════

WELCOME_VIDEO_NOTE = None  # Путь к файлу кружка, пока None
WELCOME_VIDEO_PLACEHOLDER = "[🎥 КРУЖОК: Приветствие 10-15 сек]"

WELCOME_TEXT = """
«Эй, привет! Ну что, ты уже заинтересовался досками Садху? 👋

Заглянул не просто так — чувствую, у тебя внутри есть запрос на перемены.
Здесь всё просто: я покажу, как гвозди могут поменять твою голову, тело и жизнь!

А в конце эфира... кто-то из вас унесёт домой настоящую доску Садху 🔥
Да-да, буду разыгрывать в прямом эфире. Так что готовься — будет жарко!»

🗓 Эфир уже совсем скоро — **3 января в 19:00 по МСК**.

🏠 Записывайся прямо сейчас, чтобы не пролететь мимо розыгрыша доски!

✨ Нажимай кнопку «Забронировать место»
"""

REGISTER_BUTTON = "Забронировать место ✨"

# ═══════════════════════════════════════════════════════════════
# ПОДТВЕРЖДЕНИЕ ЗАПИСИ (через 5 минут после регистрации)
# ═══════════════════════════════════════════════════════════════

CONFIRMATION_VIDEO_NOTE = None  # Путь к файлу кружка
CONFIRMATION_VIDEO_PLACEHOLDER = "[🎥 КРУЖОК: Подтверждение 8 сек]"

CONFIRMATION_TEXT = """
«Красавчик! 👋 Место за тобой.
Осталось дождаться эфира — и я покажу, что доски Садху — это не боль, а кайф, зен и энергия жизни!»

💌 А пока расскажу по секрету, зачем тебе вообще этот эфир:

🔥 Будет просто, по-человечески — без эзотерических заклинаний.
🧘 Научишься простым техникам, которые реально снижают стресс.
🏠 И главное — шанс выиграть доску Садху для практики дома 🪵

До встречи на эфире! 🙌
"""

# ═══════════════════════════════════════════════════════════════
# РОЗЫГРЫШ (рекомендация друзей)
# ═══════════════════════════════════════════════════════════════

RECOMMEND_INTRO = """
🎁 **Хочешь участвовать в розыгрыше доски Садху?**

Всё просто: порекомендуй 2 друзей, которым актуальна тема стресса, выгорания или напряжения.

📝 Отправь мне их @username через пробел:
`@friend1 @friend2`

После этого ты автоматически участвуешь в розыгрыше! 🍀
"""

RECOMMEND_SUCCESS = """
✅ Отлично! Ты в списке участников розыгрыша!

Рекомендации сохранены:
{friends}

Победителя объявим на эфире 3 января 🎉
"""

RECOMMEND_ERROR = """
❌ Нужно указать 2 юзернейма через пробел.

Пример: `@friend1 @friend2`
"""

RECOMMEND_ALREADY = """
🎯 Ты уже участвуешь в розыгрыше!

Твои рекомендации:
{friends}
"""

# ═══════════════════════════════════════════════════════════════
# НАПОМИНАНИЯ
# ═══════════════════════════════════════════════════════════════

REMINDER_24H = """
🔔 **Завтра большой день!**

Эфир «Гвозди Просто» стартует завтра в 19:00 по МСК.

Что тебя ждёт:
• Теория и практика досок Садху
• Реальные кейсы трансформации
• Ответы на вопросы
• Розыгрыш доски среди участников! 🎁

Не пропусти — поставь напоминание 📱
"""

REMINDER_1H = """
⏰ **Через 1 час начинаем!**

Готовься к эфиру:
✅ Найди тихое место
✅ Приготовь блокнот для заметок
✅ Налей чай/воду

Ссылка на эфир придёт за 5 минут до старта 🚀
"""

REMINDER_5MIN = """
☕️ **5 минут до старта!**

Завари чай/кофе, займи удобное место.
Эфир начинается ровно в 19:00 МСК.

👇 Подключайся:
"""

REMINDER_START = """
🔴 **МЫ НАЧИНАЕМ!**

Эфир "Гвозди Просто" стартовал!

👉 Подключайся: {stream_link}

Не опаздывай — самое важное в начале! 💪
"""

REMINDER_7MIN = """
🔥 **Эфир в самом разгаре!**

Уже разбираем первую технику — подключайся скорее!
Не опаздывай на розыгрыш доски 🎁

👇 Ссылка на эфир:
"""

REMINDER_START_NO_LINK = """
🔴 МЫ НАЧИНАЕМ!

Эфир "Гвозди Просто" стартовал!

⚠️ Ссылка на эфир скоро будет опубликована в канале.

📢 Следи за каналом
"""

# ═══════════════════════════════════════════════════════════════
# ПОСТ-ЭФИР (серия продажи)
# ═══════════════════════════════════════════════════════════════

POST_WEBINAR_OFFER = """
🎉 **Спасибо, что был(а) с нами!**

Надеюсь, эфир был полезным и ты почувствовал(а) силу практики.

🎁 **Специальное предложение для участников эфира:**

Видеокурс «Гвозди Просто» со скидкой **20%**!

💰 ~~5 990 ₽~~ → **4 790 ₽**

Что внутри:
• 6 видео-уроков теории
• Пошаговые практики
• 40-дневный марафон трансформации
• Чек-лист безопасности

⏱ Скидка действует **12 часов** — до {deadline}

👇 Оформить курс:
"""

POST_WEBINAR_DEADLINE_3H = """
⚡ **Осталось 3 часа!**

Скидка 20% на курс «Гвозди Просто» заканчивается через 3 часа.

💰 **4 790 ₽** вместо 5 990 ₽

🔥 **{buyers_count}+ человек уже купили** — присоединяйся!

👇 Успей до {deadline}:
"""

POST_WEBINAR_DEADLINE_1H = """
🔥 **ПОСЛЕДНИЙ ЧАС!**

Через 60 минут скидка сгорает навсегда 🔥

💰 **4 790 ₽** → станет 5 990 ₽

📊 Уже **{buyers_count}+ участников** получили доступ к курсу!

⏰ До {deadline} — это твой последний шанс.

👇 Купить сейчас:
"""

POST_WEBINAR_CLOSED = """
❌ **Скидка закончилась**

Время вышло — специальное предложение больше недоступно.

Если ты всё ещё хочешь пройти курс, он доступен по полной цене на платформе:
👉 [Ссылка на edpro.biz]

Спасибо за участие в эфире! 🙏
"""

# ═══════════════════════════════════════════════════════════════
# АДМИН-КОМАНДЫ
# ═══════════════════════════════════════════════════════════════

RAFFLE_NO_PARTICIPANTS = "❌ Нет участников с 2+ рекомендациями."

RAFFLE_WINNER = """
🎉 **ПОБЕДИТЕЛЬ РОЗЫГРЫША!**

🏆 Доска Садху достаётся: **{winner_name}** (@{winner_username})

Поздравляем! 🎊
"""

STATS_MESSAGE = """
📊 **Статистика бота**

👥 Всего пользователей: {total_users}
✅ Записались на эфир: {registered}
🎯 Участников розыгрыша: {raffle_participants}
💳 Купили курс: {buyers}

📈 Конверсия в регистрацию: {conversion}%
"""

BROADCAST_CONFIRM = "📢 Сообщение отправлено {count} пользователям."

# ═══════════════════════════════════════════════════════════════
# ПЛАТЕЖИ
# ═══════════════════════════════════════════════════════════════

PAYMENT_SUCCESS = """
✅ **Оплата прошла успешно!**

Добро пожаловать на курс «Гвозди Просто» 🎉

📚 Доступ к урокам: [платформа edpro.biz]

Если возникнут вопросы — пиши, поможем! 🙌
"""

PAYMENT_PENDING = """
⏳ Ожидаем подтверждение оплаты...

Если оплата не прошла, попробуй ещё раз или напиши нам.
"""

BUY_BUTTON = "💳 Купить курс"
BUY_BUTTON_DISCOUNT = "💳 Купить со скидкой 20%"

# ═══════════════════════════════════════════════════════════════
# ОБЩИЕ
# ═══════════════════════════════════════════════════════════════

UNKNOWN_COMMAND = """
🤔 Я пока не понимаю эту команду.

Доступные команды:
/start — Начать
/recommend — Участвовать в розыгрыше
"""

CHANNEL_LINK = "https://t.me/telminov_life8"
ADMIN_USERNAMES = ["evgenii_sharapov", "sadhustas"]  # Список админов

# Настройки эфира
WEBINAR_DATE = "2026-01-05 19:00:00"
STREAM_LINK = None  # Установить через /set_stream_link

# Цены
COURSE_PRICE = 3990
COURSE_PRICE_DISCOUNT = 2990

# ═══════════════════════════════════════════════════════════════
# ПРОГРЕВ-СЕРИЯ (ВИДЕО)
# ═══════════════════════════════════════════════════════════════

# File IDs для прогревочных видео (получены через /debug)
VIDEO_1_FILE_ID = "BAACAgIAAxkBAAMIaVpmkyHP9X2wxnXti4w4lSdfitIAAhOVAAL48aBKaSkKl5bQWuU4BA"
VIDEO_2_FILE_ID = "BAACAgIAAxkBAAMKaVpmnr0ELbyuErRnEkYp5OsaFs0AAjiVAAL48aBKX1NS5gZ_VY04BA"
VIDEO_3_FILE_ID = "BAACAgIAAxkBAAMMaVpmqZBLOLisFRHq_kbnBXN3xeUAAoCVAAL48aBK9urpDNZVO9w4BA"
VIDEO_4_FILE_ID = "BAACAgIAAxkBAAMOaVpmsT-UluFEQbQNTGZASUVnjBgAAoWVAAL48aBKe9inLiV_sn84BA"
VIDEO_5_FILE_ID = "BAACAgIAAxkBAAMQaVpmug3mASlcNlxTQ5EVAvl9RFAAAoeVAAL48aBK5__5LJOrfGw4BA"

WARMUP_1_TEXT = """
📅 Эфир уже скоро!

Здесь ты узнаешь, как включить тело, выключить стресс и перезапустить себя.

🎁 И в конце — розыгрыш доски Садху среди живых участников!

👇 Нажимай, бронируй место.
"""

WARMUP_2_TEXT = """
🚀 **Этот эфир не про разговоры — он про результаты.**

Ты узнаешь, как простые практики реально возвращают энергию и уверенность.

🎁 И да, розыгрыш доски Садху в конце — только среди тех, кто будет онлайн.
"""

WARMUP_3_TEXT = """
📅 **Эфир уже завтра — {date} в 19:00 МСК!**

🧘‍♂️ Простые техники, реальные инсайты и розыгрыш доски среди участников!

Будет жарко — подключайся вовремя.
"""

WARMUP_4_TEXT = """
⚡ **Через 1 час начинается эфир!**

🎯 Твоя доза осознанности, драйва и розыгрыш доски Садху.

Только сегодня, только в живом эфире.
"""

WARMUP_5_TEXT = """
🎁 **Специальная скидка 20% на курс “ГВОЗДИ ПРОСТО”**

🔥🔥🔥 **2990₽** вместо 3990₽

⚡ Только 12 часов после эфира.
Бонус: чеклист ежедневных практик.

Пора — действуй!
"""

def get_warmup_video(video_num: int):
    """Возвращает конфиг для прогревочного видео по номеру."""
    if video_num == 1:
        return {
            "file_id": VIDEO_1_FILE_ID,
            "caption": WARMUP_1_TEXT,
            "button_text": "✨ Забронировать место",
            "callback_data": "register_webinar"
        }
    elif video_num == 2:
        return {
            "file_id": VIDEO_2_FILE_ID,
            "caption": WARMUP_2_TEXT,
            "button_text": "🎁 Участвовать в розыгрыше",
            "callback_data": "start_recommend"
        }
    elif video_num == 3:
        # Форматируем дату для "Завтра"
        webinar_dt = datetime.strptime(WEBINAR_DATE, "%Y-%m-%d %H:%M:%S")
        date_str = webinar_dt.strftime("%d %B")
        
        # Ручной перевод месяцев, если нужно, или просто цифрами
        months = {
             1: "января", 2: "февраля", 3: "марта", 4: "апреля", 5: "мая", 6: "июня",
             7: "июля", 8: "августа", 9: "сентября", 10: "октября", 11: "ноября", 12: "декабря"
        }
        day = webinar_dt.day
        month_name = months.get(webinar_dt.month, "")
        date_formatted = f"{day} {month_name}"

        return {
            "file_id": VIDEO_3_FILE_ID,
            "caption": WARMUP_3_TEXT.format(date=date_formatted),
            "button_text": None,
            "button_url": None
        }
    elif video_num == 4:
        # Ссылка на эфир или канал
        return {
            "file_id": VIDEO_4_FILE_ID,
            "caption": WARMUP_4_TEXT,
            "button_text": "📺 Перейти к эфиру",
            "button_url": STREAM_LINK or CHANNEL_LINK
        }
    elif video_num == 5:
        return {
            "file_id": VIDEO_5_FILE_ID,
            "caption": WARMUP_5_TEXT,
            "button_text": "💳 Купить со скидкой",
            "button_url": "https://p.edpro.biz/offer-link" # Ссылка на оплату
        }
    return None
